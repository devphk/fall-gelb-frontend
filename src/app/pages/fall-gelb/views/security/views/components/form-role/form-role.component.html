<mat-stepper orientation="vertical" #stepper>
  <mat-step [stepControl]="roleFormGroup" [editable]="true">
    <form
      [formGroup]="roleFormGroup"
      fxLayout="column"
      fxLayoutAlign="space-around center"
    >
      <ng-template matStepLabel>Nuevo Rol</ng-template>
      <div fxFlex="100" fxFill fxLayoutGap="20px">
        <app-phk-input
          label="Nombre"
          formControlName="name"
          [errorMessage]="roleFormGroup.get('name')?.errors?.['required'] 
                                     ? 'Nombre es requerido def' : null"
        >
        </app-phk-input>
        <button
          mat-raised-button
          color="primary"
          (click)="selectPermissions(stepper)"
        >
          Siguiente
        </button>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="permisionFormGroup" [editable]="true">
    <form
      [formGroup]="permisionFormGroup"
      fxLayout="column"
      fxLayoutAlign="space-around center"
    >
      <ng-template matStepLabel>Asignar Permisos a Roles </ng-template>
      <div
        fxFlex="100"
        fxFill
        fxLayoutGap="20px"
        fxLayout="column"
        fxLayoutAlign="space-around none"
      >
        <div
          mat-dialog-content
          fxLayout="row wrap"
          fxLayoutGap="20px"
          fxLayout.lt-md="column"
          fxLayoutAlign="start center"
        >
          <app-phk-select
            formControlName="modulePermission"
            [label]="'Modulos'"
            fxFlex.gt-md="calc(33% - 20px)"
            fxFlex.lt-md="calc(33% - 20px)"
          >
            <mat-option
              *ngFor="let modules of modulesOptions"
              [value]="modules.id"
            >
              {{ modules.name }}
            </mat-option>
          </app-phk-select>
          <button mat-raised-button color="accent" (click)="savePermisions()">
            Guardar
          </button>
        </div>
        <app-phk-table
          [columnsTags]="tableColumnsTags"
          [columnsToDisplay]="tableColumnsToDisplay"
          [(itemsSelected)]="permisionsSelected"
          [data]="tableData"
        ></app-phk-table>
        <div
          class="container-button"
          fxFlex="100"
          fxLayout="row"
          fxLayoutAlign="space-between center"
        >
          <button mat-raised-button color="warn" matStepperPrevious>
            Anterior
          </button>
          <button
            mat-raised-button
            color="primary"
            (click)="onSubmit(roleFormGroup.value)"
          >
            Finalizar
          </button>
        </div>
      </div>
    </form>
  </mat-step>
</mat-stepper>
